<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åœ°å›³ã§å­¦ã¶åœ°ç† - åŒ—æµ·é“åœ°æ–¹ï¼ˆåœ°ç†é™¢åœ°å›³ç‰ˆï¼‰</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Hiragino Sans', 'Yu Gothic', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            padding: 10px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .home-btn {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .home-btn:hover {
            background: #ff5252;
            transform: translateY(-1px);
        }

        .lesson-title {
            font-size: 18px;
            font-weight: bold;
            color: #333;
        }

        .main-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 15px;
        }

        .map-container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            margin-bottom: 15px;
            overflow: hidden;
            position: relative;
        }

        .map-header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 15px;
            text-align: center;
        }

        .map-header h2 {
            font-size: 20px;
            margin-bottom: 5px;
        }

        .map-header p {
            font-size: 14px;
            opacity: 0.9;
        }

        .map-area {
            height: 400px;
            position: relative;
            background: #f8f9fa;
        }

        #gsi-map {
            width: 100%;
            height: 100%;
            border-radius: 0 0 15px 15px;
        }

        .info-panel {
            background: white;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            margin-bottom: 15px;
            transform: translateY(0);
            transition: transform 0.3s ease;
        }

        .info-panel.show {
            transform: translateY(0);
        }

        .info-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 15px 15px 0 0;
        }

        .info-content {
            padding: 20px;
        }

        .info-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }

        .info-item:last-child {
            border-bottom: none;
        }

        .info-label {
            font-weight: bold;
            color: #333;
            font-size: 14px;
        }

        .info-value {
            color: #666;
            font-size: 14px;
            text-align: right;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 25px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #f8f9fa;
            color: #666;
            border: 2px solid #e9ecef;
        }

        .btn-secondary:hover {
            background: #e9ecef;
        }

        .question-container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            padding: 20px;
            margin-bottom: 15px;
            display: none;
        }

        .question-container.show {
            display: block;
        }

        .question-text {
            font-size: 16px;
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
        }

        .choices {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .choice {
            padding: 12px 15px;
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .choice:hover {
            background: #e9ecef;
            border-color: #667eea;
        }

        .choice.selected {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .choice.correct {
            background: #28a745;
            color: white;
            border-color: #28a745;
        }

        .choice.incorrect {
            background: #dc3545;
            color: white;
            border-color: #dc3545;
        }

        .explanation {
            margin-top: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #667eea;
            display: none;
        }

        .explanation.show {
            display: block;
        }

        .explanation-text {
            font-size: 14px;
            color: #333;
            line-height: 1.6;
        }

        .next-btn {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 15px;
        }

        .next-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(79, 172, 254, 0.4);
        }

        .next-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .attribution {
            position: absolute;
            bottom: 5px;
            right: 5px;
            background: rgba(255, 255, 255, 0.8);
            padding: 2px 5px;
            border-radius: 3px;
            font-size: 10px;
            color: #666;
        }

        @media (max-width: 480px) {
            .main-container {
                padding: 10px;
            }
            
            .map-area {
                height: 350px;
            }
            
            .lesson-title {
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <button class="home-btn" onclick="goHome()">ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹</button>
        <div class="lesson-title">åœ°å›³ã§å­¦ã¶åœ°ç† - åŒ—æµ·é“åœ°æ–¹ï¼ˆåœ°ç†é™¢åœ°å›³ç‰ˆï¼‰</div>
        <div></div>
    </div>

    <div class="main-container">
        <div class="map-container">
            <div class="map-header">
                <h2>ğŸ—ºï¸ åœ°ç†é™¢åœ°å›³ã§åŒ—æµ·é“åœ°æ–¹ã‚’æ¢ç´¢</h2>
                <p>åœ°å›³ä¸Šã®åŒ—æµ·é“ã‚’ã‚¿ãƒƒãƒ—ã—ã¦ã€åœ°åŸŸã®æƒ…å ±ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†</p>
            </div>
            <div class="map-area">
                <div id="gsi-map"></div>
                <div class="attribution">Â© å›½åœŸåœ°ç†é™¢</div>
            </div>
        </div>

        <div class="info-panel show" id="infoPanel">
            <div class="info-header">
                <h3>ğŸ”ï¸ åŒ—æµ·é“åœ°æ–¹ã®æƒ…å ±</h3>
            </div>
            <div class="info-content">
                <div class="info-item">
                    <span class="info-label">æ°—å€™</span>
                    <span class="info-value">äºœå¯’å¸¯</span>
                </div>
                <div class="info-item">
                    <span class="info-label">å¹´å¹³å‡æ°—æ¸©</span>
                    <span class="info-value">8â„ƒ</span>
                </div>
                <div class="info-item">
                    <span class="info-label">å¹´é™æ°´é‡</span>
                    <span class="info-value">1000mm</span>
                </div>
                <div class="info-item">
                    <span class="info-label">äººå£</span>
                    <span class="info-value">ç´„530ä¸‡äºº</span>
                </div>
                <div class="info-item">
                    <span class="info-label">é¢ç©</span>
                    <span class="info-value">83,424kmÂ²</span>
                </div>
                <div class="info-item">
                    <span class="info-label">ä¸»è¦éƒ½å¸‚</span>
                    <span class="info-value">æœ­å¹Œ(197ä¸‡)ã€æ—­å·(32ä¸‡)ã€å‡½é¤¨(26ä¸‡)</span>
                </div>
                <div class="info-item">
                    <span class="info-label">ä¸»è¦å±±è„ˆ</span>
                    <span class="info-value">å¤§é›ªå±±ã€æ—¥é«˜å±±è„ˆã€çŸ³ç‹©å±±åœ°</span>
                </div>
                <div class="info-item">
                    <span class="info-label">ä¸»è¦æ²³å·</span>
                    <span class="info-value">çŸ³ç‹©å·ã€å¤©å¡©å·ã€åå‹å·</span>
                </div>
                <div class="info-item">
                    <span class="info-label">ä¸»è¦å¹³é‡</span>
                    <span class="info-value">çŸ³ç‹©å¹³é‡ã€åå‹å¹³é‡ã€æ ¹é‡§å°åœ°</span>
                </div>
                <div class="info-item">
                    <span class="info-label">ç‰¹ç”£ç‰©</span>
                    <span class="info-value">ã˜ã‚ƒãŒã„ã‚‚ã€ä¹³è£½å“ã€ç”œèœã€æ°´ç”£ç‰©</span>
                </div>
                <div class="info-item">
                    <span class="info-label">ä¸»è¦ç”£æ¥­</span>
                    <span class="info-value">è¾²æ¥­ã€æ°´ç”£æ¥­ã€è¦³å…‰æ¥­ã€è£½é€ æ¥­</span>
                </div>
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="startLearning()">å­¦ç¿’ã‚’é–‹å§‹</button>
                    <button class="btn btn-secondary" onclick="focusOnHokkaido()">åœ°å›³ã«æˆ»ã‚‹</button>
                </div>
            </div>
        </div>

        <div class="question-container" id="questionContainer">
            <div class="question-text" id="questionText"></div>
            <div class="choices" id="choices"></div>
            <div class="explanation" id="explanation">
                <div class="explanation-text" id="explanationText"></div>
            </div>
            <button class="next-btn" id="nextBtn" onclick="nextQuestion()" disabled>æ¬¡ã®å•é¡Œã¸</button>
        </div>
    </div>

    <!-- Leaflet JavaScript -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script>
        // åœ°ç†é™¢åœ°å›³ã®åˆæœŸåŒ–
        let map;
        let hokkaidoLayer;
        
        // åŒ—æµ·é“ã®GeoJSONãƒ‡ãƒ¼ã‚¿ï¼ˆç°¡ç•¥ç‰ˆï¼‰
        const hokkaidoGeoJSON = {
            "type": "FeatureCollection",
            "features": [
                {
                    "type": "Feature",
                    "properties": {
                        "name": "åŒ—æµ·é“",
                        "pref_code": "01"
                    },
                    "geometry": {
                        "type": "Polygon",
                        "coordinates": [[
                            [139.0, 45.0], [146.0, 45.0], [146.0, 41.0], [139.0, 41.0], [139.0, 45.0]
                        ]]
                    }
                }
            ]
        };

        // åŒ—æµ·é“ã®è©³ç´°ãƒ‡ãƒ¼ã‚¿
        const hokkaidoData = {
            name: 'åŒ—æµ·é“åœ°æ–¹',
            climate: 'äºœå¯’å¸¯',
            temperature: 'å¹´å¹³å‡æ°—æ¸©8â„ƒ',
            precipitation: 'å¹´é™æ°´é‡1000mm',
            cities: [
                { name: 'æœ­å¹Œ', population: '197ä¸‡äºº', lat: 43.064, lng: 141.346 },
                { name: 'æ—­å·', population: '32ä¸‡äºº', lat: 43.770, lng: 142.365 },
                { name: 'å‡½é¤¨', population: '26ä¸‡äºº', lat: 41.768, lng: 140.728 },
                { name: 'é‡§è·¯', population: '17ä¸‡äºº', lat: 43.064, lng: 144.384 }
            ],
            products: ['ã˜ã‚ƒãŒã„ã‚‚', 'ä¹³è£½å“', 'ç”œèœ', 'æ°´ç”£ç‰©'],
            geography: {
                mountains: ['å¤§é›ªå±±', 'æ—¥é«˜å±±è„ˆ', 'çŸ³ç‹©å±±åœ°'],
                rivers: ['çŸ³ç‹©å·', 'å¤©å¡©å·', 'åå‹å·'],
                plains: ['çŸ³ç‹©å¹³é‡', 'åå‹å¹³é‡', 'æ ¹é‡§å°åœ°']
            },
            industries: ['è¾²æ¥­', 'æ°´ç”£æ¥­', 'è¦³å…‰æ¥­', 'è£½é€ æ¥­'],
            questions: [
                {
                    text: 'åŒ—æµ·é“ã®æ°—å€™ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ',
                    choices: ['äºœå¯’å¸¯', 'æ¸©å¸¯', 'å†·å¸¯', 'ç†±å¸¯'],
                    answer: 0,
                    explanation: 'åŒ—æµ·é“ã¯äºœå¯’å¸¯æ°—å€™ã§ã€å†¬ã¯å¯’ãå¤ã¯æ¶¼ã—ã„æ°—å€™ã§ã™ã€‚'
                },
                {
                    text: 'åŒ—æµ·é“ã®é“åºæ‰€åœ¨åœ°ã¯ã©ã“ã§ã™ã‹ï¼Ÿ',
                    choices: ['æ—­å·', 'æœ­å¹Œ', 'å‡½é¤¨', 'é‡§è·¯'],
                    answer: 1,
                    explanation: 'æœ­å¹Œå¸‚ãŒåŒ—æµ·é“ã®é“åºæ‰€åœ¨åœ°ã§ã€äººå£ç´„197ä¸‡äººã®æœ€å¤§éƒ½å¸‚ã§ã™ã€‚'
                },
                {
                    text: 'åŒ—æµ·é“ã®ç‰¹ç”£ç‰©ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ',
                    choices: ['ã¿ã‹ã‚“', 'ã˜ã‚ƒãŒã„ã‚‚', 'ã‚Šã‚“ã”', 'ã¶ã©ã†'],
                    answer: 1,
                    explanation: 'åŒ—æµ·é“ã¯ã˜ã‚ƒãŒã„ã‚‚ã®ç”Ÿç”£ãŒç››ã‚“ã§ã€å…¨å›½ã®ç´„8å‰²ã‚’ç”Ÿç”£ã—ã¦ã„ã¾ã™ã€‚'
                },
                {
                    text: 'åŒ—æµ·é“ã§æœ€ã‚‚é•·ã„å·ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ',
                    choices: ['çŸ³ç‹©å·', 'å¤©å¡©å·', 'åå‹å·', 'é‡§è·¯å·'],
                    answer: 0,
                    explanation: 'çŸ³ç‹©å·ã¯åŒ—æµ·é“ã§æœ€ã‚‚é•·ã„å·ã§ã€å…¨é•·268kmã§ã™ã€‚'
                },
                {
                    text: 'åŒ—æµ·é“ã®ä¸»è¦ç”£æ¥­ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ',
                    choices: ['é‡å·¥æ¥­', 'è¾²æ¥­', 'é‡‘èæ¥­', 'ITç”£æ¥­'],
                    answer: 1,
                    explanation: 'åŒ—æµ·é“ã¯è¾²æ¥­ãŒä¸»è¦ç”£æ¥­ã§ã€ã˜ã‚ƒãŒã„ã‚‚ã€ç”œèœã€ä¹³è£½å“ã®ç”Ÿç”£ãŒç››ã‚“ã§ã™ã€‚'
                }
            ]
        };

        let currentQuestion = 0;
        let selectedAnswer = null;
        let isAnswered = false;

        // åœ°å›³ã®åˆæœŸåŒ–
        function initMap() {
            // åœ°ç†é™¢åœ°å›³ã®åˆæœŸåŒ–
            map = L.map('gsi-map', {
                center: [43.064, 141.346], // æœ­å¹Œã®åº§æ¨™
                zoom: 6,
                zoomControl: true,
                attributionControl: false
            });

            // åœ°ç†é™¢åœ°å›³ã®ã‚¿ã‚¤ãƒ«ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’è¿½åŠ 
            L.tileLayer('https://cyberjapandata.gsi.go.jp/xyz/std/{z}/{x}/{y}.png', {
                attribution: 'Â© å›½åœŸåœ°ç†é™¢',
                maxZoom: 18,
                minZoom: 5
            }).addTo(map);

            // åŒ—æµ·é“ã®å¢ƒç•Œç·šã‚’è¿½åŠ 
            hokkaidoLayer = L.geoJSON(hokkaidoGeoJSON, {
                style: {
                    color: '#ff6b6b',
                    weight: 3,
                    fillColor: '#ff6b6b',
                    fillOpacity: 0.3
                },
                onEachFeature: function(feature, layer) {
                    layer.on('click', function() {
                        showInfo();
                    });
                }
            }).addTo(map);

            // ä¸»è¦éƒ½å¸‚ã®ãƒãƒ¼ã‚«ãƒ¼ã‚’è¿½åŠ 
            hokkaidoData.cities.forEach(city => {
                const marker = L.marker([city.lat, city.lng])
                    .addTo(map)
                    .bindPopup(`<b>${city.name}</b><br>äººå£: ${city.population}`);
                
                marker.on('click', function() {
                    showInfo();
                });
            });

            // åœ°å›³ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
            map.on('click', function(e) {
                // ã‚¯ãƒªãƒƒã‚¯ä½ç½®ãŒåŒ—æµ·é“ã®ç¯„å›²å†…ã‹ãƒã‚§ãƒƒã‚¯
                const lat = e.latlng.lat;
                const lng = e.latlng.lng;
                
                if (lat >= 41.0 && lat <= 45.0 && lng >= 139.0 && lng <= 146.0) {
                    showInfo();
                }
            });
        }

        // æƒ…å ±ãƒ‘ãƒãƒ«ã‚’è¡¨ç¤º
        function showInfo() {
            const panel = document.getElementById('infoPanel');
            panel.classList.add('show');
        }

        // åœ°å›³ã«æˆ»ã‚‹
        function focusOnHokkaido() {
            // åœ°å›³ã‚’åŒ—æµ·é“ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹
            map.setView([43.064, 141.346], 6);
            
            // åŒ—æµ·é“ã®å¢ƒç•Œç·šã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
            hokkaidoLayer.setStyle({
                color: '#ff6b6b',
                weight: 4,
                fillColor: '#ff6b6b',
                fillOpacity: 0.4
            });
        }

        // å­¦ç¿’é–‹å§‹
        function startLearning() {
            // åœ°åŸŸæƒ…å ±ãƒ‘ãƒãƒ«ã‚’éè¡¨ç¤ºã«ã›ãšã€ãã®ã¾ã¾è¡¨ç¤º
            showQuestion();
        }

        // å•é¡Œã‚’è¡¨ç¤º
        function showQuestion() {
            const questionContainer = document.getElementById('questionContainer');
            const questionText = document.getElementById('questionText');
            const choices = document.getElementById('choices');
            const explanation = document.getElementById('explanation');
            const nextBtn = document.getElementById('nextBtn');

            questionContainer.classList.add('show');
            
            const question = hokkaidoData.questions[currentQuestion];
            questionText.textContent = question.text;
            
            choices.innerHTML = '';
            question.choices.forEach((choice, index) => {
                const choiceElement = document.createElement('div');
                choiceElement.className = 'choice';
                choiceElement.textContent = choice;
                choiceElement.onclick = () => selectAnswer(index);
                choices.appendChild(choiceElement);
            });

            explanation.classList.remove('show');
            nextBtn.disabled = true;
            nextBtn.textContent = 'æ¬¡ã®å•é¡Œã¸';
            isAnswered = false;
            selectedAnswer = null;
        }

        // ç­”ãˆã‚’é¸æŠ
        function selectAnswer(index) {
            if (isAnswered) return;

            selectedAnswer = index;
            const choices = document.querySelectorAll('.choice');
            choices.forEach((choice, i) => {
                choice.classList.remove('selected');
                if (i === index) {
                    choice.classList.add('selected');
                }
            });

            const nextBtn = document.getElementById('nextBtn');
            nextBtn.disabled = false;
            nextBtn.textContent = 'ç­”ãˆã‚’ç¢ºèª';
        }

        // ç­”ãˆã‚’ç¢ºèª
        function checkAnswer() {
            if (selectedAnswer === null) return;

            isAnswered = true;
            const question = hokkaidoData.questions[currentQuestion];
            const choices = document.querySelectorAll('.choice');
            const explanation = document.getElementById('explanation');
            const explanationText = document.getElementById('explanationText');
            const nextBtn = document.getElementById('nextBtn');

            choices.forEach((choice, index) => {
                choice.classList.remove('selected');
                if (index === question.answer) {
                    choice.classList.add('correct');
                } else if (index === selectedAnswer && index !== question.answer) {
                    choice.classList.add('incorrect');
                }
            });

            explanationText.textContent = question.explanation;
            explanation.classList.add('show');
            nextBtn.textContent = currentQuestion < hokkaidoData.questions.length - 1 ? 'æ¬¡ã®å•é¡Œã¸' : 'å­¦ç¿’å®Œäº†';
        }

        // æ¬¡ã®å•é¡Œã¸
        function nextQuestion() {
            if (!isAnswered) {
                checkAnswer();
                return;
            }

            currentQuestion++;
            if (currentQuestion < hokkaidoData.questions.length) {
                showQuestion();
            } else {
                // å­¦ç¿’å®Œäº†
                alert('ğŸ‰ åŒ—æµ·é“åœ°æ–¹ã®å­¦ç¿’ãŒå®Œäº†ã—ã¾ã—ãŸï¼\n\nåœ°ç†é™¢åœ°å›³ã§å­¦ã¶åŠ¹æœï¼š\nãƒ»æ­£ç¢ºãªåœ°å›³ã§ä½ç½®é–¢ä¿‚ã‚’ç†è§£\nãƒ»å®Ÿéš›ã®åœ°å½¢ã‚’ç¢ºèª\nãƒ»åœ°ç†çš„ãªç‰¹å¾´ã‚’è¦–è¦šçš„ã«å­¦ç¿’');
                goHome();
            }
        }

        // ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹
        function goHome() {
            window.location.href = '../../index.html';
        }

        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initMap();
        });
    </script>
</body>
</html>
